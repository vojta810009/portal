<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="cs" lang="cs">  
<head>  
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">    
  <title>SFRI.gov - Portál vlády</title>  
  <link href="./styl.css" rel="stylesheet" type="text/css">  
  <link href="style-portal.css" rel="stylesheet" type="text/css">  
  <style>  
    #portalContent { display: none; }  
    #logoutTimer { font-weight: bold; color: yellow; }  
    
    /* ZÁKLADNÍ STYLY */
    body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      background: #f5f5f5;
    }
    
    /* HORNÍ LIŠTA */
    .top-bar {
      background: #8b0000;
      color: white;
      padding: 15px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    
    .top-bar-info {
      display: flex;
      gap: 20px;
      align-items: center;
    }
    
    .top-bar-buttons {
      display: flex;
      gap: 10px;
    }
    
    .top-bar button {
      background: #c00;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
    }
    
    .top-bar button:hover {
      background: #a00;
    }
    
    /* ZÁLOŽKY */
    .tabs { 
      display: flex; 
      background: #e0e0e0; 
      padding: 0 20px;
      border-bottom: 2px solid #c00;
    }
    
    .tab { 
      padding: 12px 24px; 
      background: #d0d0d0; 
      cursor: pointer; 
      margin-right: 2px; 
      border-radius: 5px 5px 0 0;
      font-weight: bold;
    }
    
    .tab:hover { 
      background: #c0c0c0; 
    }
    
    .tab.active { 
      background: #c00; 
      color: white; 
    }
    
    /* OBSAH */
    .tab-content { 
      display: none; 
      padding: 20px; 
      min-height: 400px;
    }
    
    .tab-content.active { 
      display: block; 
    }
    
    /* OSOBNÍ INFORMACE */
    .personal-info {
      background: white;
      padding: 20px;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    
    .personal-info table {
      width: 100%;
      border-collapse: collapse;
    }
    
    .personal-info td {
      padding: 8px;
      border-bottom: 1px solid #eee;
    }
    
    /* NOVINKY */
    .news-section {
      background: white;
      padding: 20px;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    
    .news-item {
      margin-bottom: 20px;
      padding: 15px;
      border-left: 4px solid #c00;
      background: #f9f9f9;
    }
    
    .news-title {
      color: #c00;
      margin: 0 0 10px 0;
    }
    
    .news-date {
      color: #666;
      font-size: 0.9em;
      margin-bottom: 10px;
    }
    
    .news-text {
      line-height: 1.5;
    }
    
    /* ADMINISTRACE */
    .admin-section {
      background: white;
      padding: 20px;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    
    .admin-form {
      margin-bottom: 30px;
      padding: 20px;
      background: #f9f9f9;
      border-radius: 5px;
    }
    
    .admin-form input[type="text"],
    .admin-form textarea {
      width: 100%;
      max-width: 500px;
      padding: 8px;
      margin-bottom: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 16px;
    }
    
    .admin-form textarea {
      height: 100px;
      resize: vertical;
    }
    
    .admin-form button {
      background: #c00;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
      font-size: 16px;
    }
    
    .admin-form button:hover {
      background: #a00;
    }
    
    /* LOGIN */
    .login-section {
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      background: linear-gradient(135deg, #8b0000 0%, #c00 100%);
    }
    
    .login-box {
      background: white;
      padding: 40px;
      border-radius: 10px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
      text-align: center;
      max-width: 400px;
      width: 90%;
    }
    
    .login-box h1 {
      color: #8b0000;
      margin-bottom: 20px;
    }
    
    .login-box input[type="text"],
    .login-box input[type="password"] {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 16px;
      box-sizing: border-box;
    }
    
    .login-box button {
      background: #c00;
      color: white;
      border: none;
      padding: 12px 30px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
      margin-top: 10px;
      width: 100%;
    }
    
    .login-box button:hover {
      background: #a00;
    }
    
    .login-logo {
      width: 200px;
      margin-bottom: 20px;
    }
    
    /* STATUS ZPRÁVY */
    .status-message {
      padding: 10px;
      margin: 10px 0;
      border-radius: 4px;
      display: none;
    }
    
    .status-success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }
    
    .status-error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
  </style>  
</head>  
<body role="application">
  
  <!-- LOGIN SEKCE -->  
  <div id="loginSection" class="login-section">
    <div class="login-box">
      <h1>Vítejte v Portálu vlády SFRI</h1>
      <img class="login-logo" src="SFRI-male.png" alt="Logo SFRI">
      <h3>"Socialistická Federativní Republika IngLAND"</h3>
      
      <div id="loginStatus" class="status-message"></div>
      
      <input type="text" id="username" placeholder="ID občana">
      <input type="password" id="password" placeholder="Heslo">
      <button onclick="checkLogin()">Přihlásit se</button>
      
      <div style="margin-top: 20px; font-size: 0.9em; color: #666;">
        <strong>Testovací účty:</strong><br>
        • admin / admin123 (administrátor)<br>
        • user1 / demo123 (běžný uživatel)
      </div>
    </div>
  </div>
  
  <!-- PORTÁL VLÁDY SEKCE -->  
  <div id="portalContent">
    <!-- HORNÍ LIŠTA -->
    <div class="top-bar">
      <div class="top-bar-info">
        <div>Přihlášen jako: <strong id="userFullName">---</strong></div>
        <div>Odhlášení za: <strong id="logoutTimer">--:--</strong></div>
      </div>
      <div class="top-bar-buttons">
        <button onclick="logout()">Odhlášení</button>
      </div>
    </div>
    
    <!-- NAVIGAČNÍ ZÁLOŽKY -->
    <div class="tabs">
      <div class="tab active" onclick="switchToTab('personal')">Osobní informace</div>
      <div class="tab" onclick="switchToTab('news')">Portál vlády</div>
      <div class="tab" id="adminTab" style="display: none;" onclick="switchToTab('admin')">Administrace</div>
    </div>
    
    <!-- STATUS ZPRÁVY -->
    <div id="statusMessage" class="status-message"></div>
    
    <!-- OSOBNÍ INFORMACE -->
    <div id="personalTab" class="tab-content active">
      <div class="personal-info">
        <h2>Osobní informace</h2>
        <table>
          <tr><td><strong>Přihlášen jako:</strong></td><td id="userName">---</td></tr>
          <tr><td><strong>Člen týmu:</strong></td><td id="userTeam">---</td></tr>
          <tr><td><strong>Spolučlenové:</strong></td><td id="userTeamMembers">---</td></tr>
          <tr><td colspan="2"><hr></td></tr>
          <tr><td colspan="2" style="text-align: center;"><h3>FINANČNÍ STAV</h3></td></tr>
          <tr>
            <td style="text-align: center; width: 50%;">
              <h4>Osobní účet</h4>
              <div style="font-size: 24px; color: #c00;" id="personalBalance">---</div>
              <div id="personalBlock">Blokace: 0 ILD</div>
            </td>
            <td style="text-align: center; width: 50%;">
              <h4>Týmový účet</h4>
              <div style="font-size: 24px; color: #c00;" id="teamBalance">---</div>
              <div id="teamBlock">Blokace: 0 ILD</div>
            </td>
          </tr>
          <tr><td colspan="2"><hr></td></tr>
          <tr><td><strong>Poslední přihlášení:</strong></td><td id="lastLogin">---</td></tr>
        </table>
      </div>
    </div>
    
    <!-- PORTÁL VLÁDY - NOVINKY -->
    <div id="newsTab" class="tab-content">
      <div class="news-section">
        <h2>Oficiální zprávy vlády SFRI</h2>
        <div id="newsContainer">
          <!-- Novinky se načtou dynamicky -->
        </div>
      </div>
    </div>
    
    <!-- ADMINISTRACE -->
    <div id="adminTabContent" class="tab-content">
      <div class="admin-section">
        <h2>Administrace portálu vlády</h2>
        
        <div class="admin-form">
          <h3>Nahrát novou zprávu</h3>
          <input type="text" id="newsTitle" placeholder="Nadpis zprávy">
          <textarea id="newsText" placeholder="Text zprávy"></textarea>
          <button onclick="uploadNews()">Zveřejnit zprávu</button>
        </div>
        
        <h3>Správa existujících zpráv</h3>
        <div id="adminNewsList">
          <!-- Zprávy pro správu -->
        </div>
      </div>
    </div>
    
  </div>

  <script>  
    // UŽIVATELÉ
    const users = {
      "admin": {
        fullName: "Administrátor portálu",
        userName: "admin",
        team: "Administrace",
        teamMembers: "Systémový administrátor",
        personalBalance: "999,999,999 ILD",
        personalBlock: "Blokace: 0 ILD",
        teamBalance: "∞ ILD",
        teamBlock: "Blokace: 0 ILD",
        password: "admin123",
        isAdmin: true
      },
      "user1": {
        fullName: "Člen vlády SFRI",
        userName: "Uživatel 1",
        team: "Vláda SFRI",
        teamMembers: "Člen A, Člen B, Člen C",
        personalBalance: "1,000,000 ILD",
        personalBlock: "Blokace: 0 ILD",
        teamBalance: "∞ ILD",
        teamBlock: "Blokace: 0 ILD",
        password: "demo123",
        isAdmin: false
      }
    };
    
    // NOVINKY
    let news = JSON.parse(localStorage.getItem('sfriNews')) || [
      {
        id: 1,
        title: "Vláda SFRI schválila nový rozpočet",
        text: "Vláda Socialistické Federativní Republiky IngLAND dnes schválila rozpočet na příští rok s důrazem na sociální programy a rozvoj infrastruktury.",
        date: new Date().toLocaleString('cs-CZ'),
        author: "admin"
      },
      {
        id: 2,
        title: "Zahájen projekt modernizace železnic",
        text: "Byl zahájen ambiciózní projekt na modernizaci železniční sítě, který zlepší spojení mezi všemi regiony SFRI.",
        date: new Date(Date.now() - 86400000).toLocaleString('cs-CZ'),
        author: "admin"
      }
    ];
    
    // PROMĚNNÉ
    let currentUser = null;
    let logoutTime = 600; // 10 minut
    
    // FUNKCE
    function showStatus(message, type = 'success') {
      const statusDiv = document.getElementById('statusMessage');
      statusDiv.textContent = message;
      statusDiv.className = `status-message status-${type}`;
      statusDiv.style.display = 'block';
      
      setTimeout(() => {
        statusDiv.style.display = 'none';
      }, 3000);
    }
    
    function checkLogin() {
      const username = document.getElementById('username').value.trim();
      const password = document.getElementById('password').value;
      const loginStatus = document.getElementById('loginStatus');
      
      if (!username || !password) {
        loginStatus.textContent = 'Vyplňte uživatelské jméno i heslo!';
        loginStatus.className = 'status-message status-error';
        loginStatus.style.display = 'block';
        return;
      }
      
      if (users[username] && users[username].password === password) {
        currentUser = username;
        localStorage.setItem('loggedInUser', username);
        localStorage.setItem('lastLogin', new Date().toLocaleString('cs-CZ'));
        
        loginStatus.style.display = 'none';
        showPortalForUser(username);
        
        document.getElementById('loginSection').style.display = 'none';
        document.getElementById('portalContent').style.display = 'block';
        
        // Zobrazit admin tab pokud je uživatel admin
        const adminTab = document.getElementById('adminTab');
        if (users[username].isAdmin) {
          adminTab.style.display = 'block';
        } else {
          adminTab.style.display = 'none';
        }
        
        resetLogoutTimer();
        loadNews();
        if (users[username].isAdmin) {
          loadAdminNews();
        }
        
        showStatus(`Vítejte, ${username}!`, 'success');
      } else {
        loginStatus.textContent = 'Neplatné přihlašovací údaje!';
        loginStatus.className = 'status-message status-error';
        loginStatus.style.display = 'block';
      }
    }
    
    function showPortalForUser(username) {
      const user = users[username];
      if (!user) return;
      
      document.getElementById('userFullName').textContent = user.fullName;
      document.getElementById('userName').textContent = user.userName;
      document.getElementById('userTeam').textContent = user.team;
      document.getElementById('userTeamMembers').textContent = user.teamMembers;
      document.getElementById('personalBalance').textContent = user.personalBalance;
      document.getElementById('personalBlock').textContent = user.personalBlock;
      document.getElementById('teamBalance').textContent = user.teamBalance;
      document.getElementById('teamBlock').textContent = user.teamBlock;
      
      const lastLogin = localStorage.getItem('lastLogin') || new Date().toLocaleString('cs-CZ');
      document.getElementById('lastLogin').textContent = lastLogin;
    }
    
    function switchToTab(tabName) {
      console.log('Přepínám na:', tabName);
      
      // Kontrola pro admin
      if (tabName === 'admin' && (!currentUser || !users[currentUser] || !users[currentUser].isAdmin)) {
        showStatus('Nemáte oprávnění pro přístup do administrace!', 'error');
        return;
      }
      
      // Skrýt všechny záložky
      document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active');
      });
      
      // Deaktivovat všechny taby
      document.querySelectorAll('.tab').forEach(tab => {
        tab.classList.remove('active');
      });
      
      // Aktivovat vybranou záložku
      const targetTab = document.getElementById(tabName + 'Tab');
      if (targetTab) {
        targetTab.classList.add('active');
        
        // Aktivovat odpovídající tab
        document.querySelectorAll('.tab').forEach(tab => {
          if (tab.textContent.includes(
            tabName === 'personal' ? 'Osobní' : 
            tabName === 'news' ? 'Portál' : 
            'Administrace'
          )) {
            tab.classList.add('active');
          }
        });
        
        // Načíst data pro admin
        if (tabName === 'admin') {
          loadAdminNews();
        }
      }
    }
    
    function loadNews() {
      const container = document.getElementById('newsContainer');
      container.innerHTML = '';
      
      if (news.length === 0) {
        container.innerHTML = '<p>Zatím nebyly publikovány žádné zprávy.</p>';
        return;
      }
      
      // Seřadit od nejnovější
      const sortedNews = [...news].sort((a, b) => new Date(b.date) - new Date(a.date));
      
      sortedNews.forEach(item => {
        const newsDiv = document.createElement('div');
        newsDiv.className = 'news-item';
        newsDiv.innerHTML = `
          <div class="news-date"><strong>${item.date}</strong> | Autor: ${item.author}</div>
          <h3 class="news-title">${item.title}</h3>
          <div class="news-text">${item.text}</div>
        `;
        container.appendChild(newsDiv);
      });
    }
    
    function loadAdminNews() {
      const container = document.getElementById('adminNewsList');
      container.innerHTML = '';
      
      if (news.length === 0) {
        container.innerHTML = '<p>Žádné zprávy k zobrazení.</p>';
        return;
      }
      
      // Seřadit od nejnovější
      const sortedNews = [...news].sort((a, b) => new Date(b.date) - new Date(a.date));
      
      sortedNews.forEach(item => {
        const newsDiv = document.createElement('div');
        newsDiv.className = 'news-item';
        newsDiv.innerHTML = `
          <div class="news-date"><strong>${item.date}</strong> | ID: ${item.id}</div>
          <h3 class="news-title">${item.title}</h3>
          <div class="news-text">${item.text}</div>
          <button class="delete-btn" onclick="deleteNews(${item.id})" 
                  style="background: #dc3545; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; margin-top: 10px;">
            Smazat zprávu
          </button>
        `;
        container.appendChild(newsDiv);
      });
    }
    
    function uploadNews() {
      if (!currentUser || !users[currentUser] || !users[currentUser].isAdmin) {
        showStatus('Pouze administrátor může publikovat zprávy!', 'error');
        return;
      }
      
      const title = document.getElementById('newsTitle').value.trim();
      const text = document.getElementById('newsText').value.trim();
      
      if (!title || !text) {
        showStatus('Vyplňte nadpis i text zprávy!', 'error');
        return;
      }
      
      // Vytvořit novou zprávu
      const newId = news.length > 0 ? Math.max(...news.map(n => n.id)) + 1 : 1;
      const newItem = {
        id: newId,
        title: title,
        text: text,
        date: new Date().toLocaleString('cs-CZ'),
        author: currentUser
      };
      
      // Přidat zprávu
      news.push(newItem);
      localStorage.setItem('sfriNews', JSON.stringify(news));
      
      // Vyčistit formulář
      document.getElementById('newsTitle').value = '';
      document.getElementById('newsText').value = '';
      
      // Přenačíst zprávy
      loadNews();
      loadAdminNews();
      
      showStatus('Zpráva byla úspěšně publikována!', 'success');
      
      // Přepnout na záložku novinek
      setTimeout(() => {
        switchToTab('news');
      }, 1000);
    }
    
    function deleteNews(id) {
      if (!confirm('Opravdu chcete smazat tuto zprávu?')) {
        return;
      }
      
      const originalLength = news.length;
      news = news.filter(item => item.id !== id);
      localStorage.setItem('sfriNews', JSON.stringify(news));
      
      loadNews();
      loadAdminNews();
      
      showStatus(`Zpráva byla smazána. (${originalLength} → ${news.length} zpráv)`, 'success');
    }
    
    function logout() {
      currentUser = null;
      localStorage.removeItem('loggedInUser');
      
      document.getElementById('portalContent').style.display = 'none';
      document.getElementById('loginSection').style.display = 'flex';
      
      document.getElementById('username').value = '';
      document.getElementById('password').value = '';
      document.getElementById('loginStatus').style.display = 'none';
      
      clearInterval(window.logoutTimerInterval);
      document.getElementById('logoutTimer').textContent = '--:--';
    }
    
    function resetLogoutTimer() {
      logoutTime = 600;
      clearInterval(window.logoutTimerInterval);
      updateLogoutTimer();
      
      window.logoutTimerInterval = setInterval(() => {
        logoutTime--;
        updateLogoutTimer();
        
        if (logoutTime <= 0) {
          logout();
          alert('Byl jste automaticky odhlášen z důvodu nečinnosti.');
        }
      }, 1000);
    }
    
    function updateLogoutTimer() {
      const minutes = Math.floor(logoutTime / 60);
      const seconds = logoutTime % 60;
      document.getElementById('logoutTimer').textContent = 
        `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    }
    
    // ENTER pro přihlášení
    document.addEventListener('DOMContentLoaded', function() {
      document.getElementById('password').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          checkLogin();
        }
      });
      
      document.getElementById('username').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          checkLogin();
        }
      });
    });
    
    // AUTO-PŘIHLÁŠENÍ
    window.onload = function() {
      const savedUser = localStorage.getItem('loggedInUser');
      
      if (savedUser && users[savedUser]) {
        currentUser = savedUser;
        showPortalForUser(savedUser);
        
        document.getElementById('loginSection').style.display = 'none';
        document.getElementById('portalContent').style.display = 'block';
        
        // Zobrazit admin tab pokud je uživatel admin
        const adminTab = document.getElementById('adminTab');
        if (users[savedUser].isAdmin) {
          adminTab.style.display = 'block';
        } else {
          adminTab.style.display = 'none';
        }
        
        resetLogoutTimer();
        loadNews();
        if (users[savedUser].isAdmin) {
          loadAdminNews();
        }
      }
      
      // Načíst novinky
      const savedNews = localStorage.getItem('sfriNews');
      if (savedNews) {
        try {
          news = JSON.parse(savedNews);
        } catch (e) {
          console.error('Chyba při načítání novinek:', e);
          news = [];
        }
      }
    };
  </script>
</body>
</html>

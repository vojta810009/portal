<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="cs" lang="cs">  
<head>  
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">    
  <title>SFRI.gov - Port√°l vl√°dy</title>  
  <link href="./styl.css" rel="stylesheet" type="text/css">  
  <link href="style-portal.css" rel="stylesheet" type="text/css">  
  <style>  
    #portalContent { display: none; }  
    #logoutTimer { font-weight: bold; color: yellow; }  
    
    /* Z√ÅKLADN√ç STYLY */
    body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      background: #f5f5f5;
    }
    
    /* HORN√ç LI≈†TA */
    .top-bar {
      background: #8b0000;
      color: white;
      padding: 15px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    
    .top-bar-info {
      display: flex;
      gap: 20px;
      align-items: center;
    }
    
    .top-bar-buttons {
      display: flex;
      gap: 10px;
    }
    
    .top-bar button {
      background: #c00;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
    }
    
    .top-bar button:hover {
      background: #a00;
    }
    
    /* Z√ÅLO≈ΩKY */
    .tabs { 
      display: flex; 
      background: #e0e0e0; 
      padding: 0 20px;
      border-bottom: 2px solid #c00;
      flex-wrap: wrap;
    }
    
    .tab { 
      padding: 12px 24px; 
      background: #d0d0d0; 
      cursor: pointer; 
      margin-right: 2px; 
      border-radius: 5px 5px 0 0;
      font-weight: bold;
      white-space: nowrap;
    }
    
    .tab:hover { 
      background: #c0c0c0; 
    }
    
    .tab.active { 
      background: #c00; 
      color: white; 
    }
    
    /* OBSAH */
    .tab-content { 
      display: none; 
      padding: 20px; 
      min-height: 400px;
    }
    
    .tab-content.active { 
      display: block; 
    }
    
    /* OSOBN√ç INFORMACE */
    .personal-info {
      background: white;
      padding: 20px;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    
    .personal-info table {
      width: 100%;
      border-collapse: collapse;
    }
    
    .personal-info td {
      padding: 8px;
      border-bottom: 1px solid #eee;
    }
    
    /* NOVINKY */
    .news-section {
      background: white;
      padding: 20px;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    
    .news-item {
      margin-bottom: 20px;
      padding: 15px;
      border-left: 4px solid #c00;
      background: #f9f9f9;
    }
    
    .news-title {
      color: #c00;
      margin: 0 0 10px 0;
    }
    
    .news-date {
      color: #666;
      font-size: 0.9em;
      margin-bottom: 10px;
    }
    
    .news-text {
      line-height: 1.5;
    }
    
    .news-attachment {
      margin-top: 10px;
      padding: 8px;
      background: #e9e9e9;
      border-radius: 4px;
      font-size: 0.9em;
    }
    
    .news-attachment a {
      color: #c00;
      text-decoration: none;
      font-weight: bold;
    }
    
    .news-attachment a:hover {
      text-decoration: underline;
    }
    
    /* ADMINISTRACE - OBECN√â */
    .admin-section {
      background: white;
      padding: 20px;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    
    .admin-form {
      margin-bottom: 30px;
      padding: 20px;
      background: #f9f9f9;
      border-radius: 5px;
    }
    
    .admin-form input[type="text"],
    .admin-form input[type="password"],
    .admin-form input[type="number"],
    .admin-form select,
    .admin-form textarea {
      width: 100%;
      max-width: 500px;
      padding: 8px;
      margin-bottom: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 16px;
      box-sizing: border-box;
    }
    
    .admin-form textarea {
      height: 100px;
      resize: vertical;
    }
    
    .admin-form button {
      background: #c00;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
      font-size: 16px;
      margin-right: 10px;
      margin-bottom: 5px;
    }
    
    .admin-form button:hover {
      background: #a00;
    }
    
    .admin-form button.secondary {
      background: #666;
    }
    
    .admin-form button.secondary:hover {
      background: #555;
    }
    
    /* ADMIN - SPR√ÅVA √öƒåT≈Æ */
    .accounts-list {
      margin-top: 20px;
    }
    
    .account-item {
      padding: 15px;
      margin-bottom: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      background: #f9f9f9;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .account-info {
      flex: 1;
    }
    
    .account-actions {
      display: flex;
      gap: 10px;
    }
    
    /* TRANSAKCE */
    .transactions-section {
      background: white;
      padding: 20px;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    
    .transaction-item {
      padding: 15px;
      margin-bottom: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      background: #f9f9f9;
    }
    
    .transaction-pending {
      border-left: 4px solid #ff9800;
    }
    
    .transaction-approved {
      border-left: 4px solid #4caf50;
    }
    
    .transaction-rejected {
      border-left: 4px solid #f44336;
    }
    
    .transaction-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
    }
    
    .transaction-actions {
      margin-top: 10px;
      display: flex;
      gap: 10px;
    }
    
    .transaction-actions button {
      padding: 5px 15px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
    }
    
    .btn-approve {
      background: #4caf50;
      color: white;
    }
    
    .btn-reject {
      background: #f44336;
      color: white;
    }
    
    /* LOGIN */
    .login-section {
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      background: linear-gradient(135deg, #8b0000 0%, #c00 100%);
    }
    
    .login-box {
      background: white;
      padding: 40px;
      border-radius: 10px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
      text-align: center;
      max-width: 400px;
      width: 90%;
    }
    
    .login-box h1 {
      color: #8b0000;
      margin-bottom: 20px;
    }
    
    .login-box input[type="text"],
    .login-box input[type="password"] {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 16px;
      box-sizing: border-box;
    }
    
    .login-box button {
      background: #c00;
      color: white;
      border: none;
      padding: 12px 30px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
      margin-top: 10px;
      width: 100%;
    }
    
    .login-box button:hover {
      background: #a00;
    }
    
    .login-logo {
      width: 200px;
      margin-bottom: 20px;
    }
    
    /* STATUS ZPR√ÅVY */
    .status-message {
      padding: 10px;
      margin: 10px 0;
      border-radius: 4px;
      display: none;
    }
    
    .status-success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }
    
    .status-error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
    
    /* TABULKY */
    .data-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    
    .data-table th {
      background: #8b0000;
      color: white;
      padding: 10px;
      text-align: left;
    }
    
    .data-table td {
      padding: 10px;
      border-bottom: 1px solid #ddd;
    }
    
    .data-table tr:hover {
      background: #f5f5f5;
    }
    
    /* FILTROV√ÅN√ç */
    .filter-section {
      background: #f9f9f9;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 5px;
    }
    
    .filter-section input,
    .filter-section select {
      padding: 8px;
      margin-right: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
    }
  </style>  
</head>  
<body role="application">
  
  <!-- LOGIN SEKCE -->  
  <div id="loginSection" class="login-section">
    <div class="login-box">
      <h1>V√≠tejte v Port√°lu vl√°dy SFRI</h1>
      <img class="login-logo" src="SFRI-male.png" alt="Logo SFRI">
      <h3>"Socialistick√° Federativn√≠ Republika IngLAND"</h3>
      
      <div id="loginStatus" class="status-message"></div>
      
      <input type="text" id="username" placeholder="ID obƒçana">
      <input type="password" id="password" placeholder="Heslo">
      <button onclick="checkLogin()">P≈ôihl√°sit se</button>
    </div>
  </div>
  
  <!-- PORT√ÅL VL√ÅDY SEKCE -->  
  <div id="portalContent">
    <!-- HORN√ç LI≈†TA -->
    <div class="top-bar">
      <div class="top-bar-info">
        P≈ôihl√°≈°en jako: <strong id="userFullName">---</strong>
        | Odhl√°≈°en√≠ za: <strong id="logoutTimer">--:--</strong>
      </div>
      <div class="top-bar-buttons">
        <button onclick="switchToTab('news')">Port√°l vl√°dy</button>
        <button onclick="logout()">Odhl√°≈°en√≠</button>
      </div>
    </div>
    
    <!-- NAVIGAƒåN√ç Z√ÅLO≈ΩKY -->
    <div class="tabs">
      <div class="tab active" data-tab="personal" onclick="switchToTab('personal')">Osobn√≠ informace</div>
      <div class="tab" data-tab="news" onclick="switchToTab('news')">Port√°l vl√°dy</div>
      <div class="tab" data-tab="transactions" id="transactionsTabButton" onclick="switchToTab('transactions')">Transakce</div>
      <div class="tab" data-tab="admin" id="adminTabButton" style="display: none;" onclick="switchToTab('admin')">Administrace</div>
    </div>
    
    <!-- STATUS ZPR√ÅVY -->
    <div id="statusMessage" class="status-message"></div>
    
    <!-- OSOBN√ç INFORMACE -->
    <div id="personalTab" class="tab-content active">
      <div class="personal-info">
        <h2>Osobn√≠ informace</h2>
        <table>
          <tr><td><strong>P≈ôihl√°≈°en jako:</strong></td><td id="userName">---</td></tr>
          <tr><td><strong>ƒålen t√Ωmu:</strong></td><td id="userTeam">---</td></tr>
          <tr><td><strong>Spoluƒçlenov√©:</strong></td><td id="userTeamMembers">---</td></tr>
          <tr><td colspan="2"><hr></td></tr>
          <tr><td colspan="2" style="text-align: center;"><h3>FINANƒåN√ç STAV</h3></td></tr>
          <tr>
            <td style="text-align: center; width: 50%;">
              <h4>Osobn√≠ √∫ƒçet</h4>
              <div style="font-size: 24px; color: #c00;" id="personalBalance">---</div>
              <div id="personalBlock">Blokace: 0 ILD</div>
            </td>
            <td style="text-align: center; width: 50%;">
              <h4>T√Ωmov√Ω √∫ƒçet</h4>
              <div style="font-size: 24px; color: #c00;" id="teamBalance">---</div>
              <div id="teamBlock">Blokace: 0 ILD</div>
            </td>
          </tr>
          <tr><td colspan="2"><hr></td></tr>
          <tr><td><strong>Posledn√≠ p≈ôihl√°≈°en√≠:</strong></td><td id="lastLogin">---</td></tr>
        </table>
      </div>
    </div>
    
    <!-- PORT√ÅL VL√ÅDY - NOVINKY -->
    <div id="newsTab" class="tab-content">
      <div class="news-section">
        <h2>Ofici√°ln√≠ zpr√°vy vl√°dy SFRI</h2>
        <div id="newsContainer"></div>
      </div>
    </div>
    
    <!-- TRANSAKCE -->
    <div id="transactionsTab" class="tab-content">
      <div class="transactions-section">
        <h2>Spr√°va transakc√≠</h2>
        <div class="filter-section">
          <select id="transactionFilter" onchange="filterTransactions()">
            <option value="all">V≈°echny transakce</option>
            <option value="pending">ƒåekaj√≠c√≠ na schv√°len√≠</option>
            <option value="approved">Schv√°len√©</option>
            <option value="rejected">Zam√≠tnut√©</option>
          </select>
          <button onclick="showNewTransactionForm()" style="background: #4caf50;">+ Nov√° transakce</button>
        </div>
        
        <!-- Formul√°≈ô pro novou transakci -->
        <div id="newTransactionForm" class="admin-form" style="display: none;">
          <h3>N√°vrh nov√© transakce</h3>
          <input type="text" id="transactionTitle" placeholder="N√°zev transakce">
          <textarea id="transactionDescription" placeholder="Popis transakce"></textarea>
          <input type="number" id="transactionAmount" placeholder="ƒå√°stka (ILD)" min="1">
          <select id="transactionRecipient">
            <option value="">Vyberte p≈ô√≠jemce</option>
          </select>
          <button onclick="submitTransaction()">Odeslat ke schv√°len√≠</button>
          <button onclick="hideNewTransactionForm()" class="secondary">Zru≈°it</button>
        </div>
        
        <!-- Seznam transakc√≠ -->
        <div id="transactionsContainer"></div>
      </div>
    </div>
    
    <!-- ADMINISTRACE -->
    <div id="adminTab" class="tab-content">
      <div class="admin-section">
        <h2>Administrace port√°lu vl√°dy</h2>
        
        <div class="tabs" style="background: transparent; border-bottom: 1px solid #ddd; margin-bottom: 20px;">
          <div class="tab active" data-admin-tab="users" onclick="switchAdminTab('users')">Spr√°va √∫ƒçt≈Ø</div>
          <div class="tab" data-admin-tab="news" onclick="switchAdminTab('news')">Spr√°va zpr√°v</div>
          <div class="tab" data-admin-tab="transactions" onclick="switchAdminTab('transactions')">Spr√°va transakc√≠</div>
        </div>
        
        <!-- SPR√ÅVA √öƒåT≈Æ -->
        <div id="adminUsersTab" class="admin-tab-content active">
          <h3>Spr√°va u≈æivatelsk√Ωch √∫ƒçt≈Ø</h3>
          
          <div class="admin-form">
            <h4>Vytvo≈ôit nov√Ω √∫ƒçet</h4>
            <input type="text" id="newUsername" placeholder="U≈æivatelsk√© jm√©no">
            <input type="password" id="newPassword" placeholder="Heslo">
            <input type="text" id="newFullName" placeholder="Cel√© jm√©no">
            <input type="text" id="newTeam" placeholder="T√Ωm">
            <input type="text" id="newTeamMembers" placeholder="ƒålenov√© t√Ωmu (oddƒõlte ƒç√°rkou)">
            <input type="number" id="newBalance" placeholder="Poƒç√°teƒçn√≠ z≈Østatek (ILD)">
            <select id="newIsAdmin">
              <option value="false">Bƒõ≈æn√Ω u≈æivatel</option>
              <option value="true">Administr√°tor</option>
            </select>
            <button onclick="createUser()">Vytvo≈ôit √∫ƒçet</button>
          </div>
          
          <h4>Existuj√≠c√≠ √∫ƒçty</h4>
          <div class="accounts-list" id="accountsList"></div>
        </div>
        
        <!-- SPR√ÅVA ZPR√ÅV -->
        <div id="adminNewsTab" class="admin-tab-content">
          <h3>Spr√°va zpr√°v</h3>
          
          <div class="admin-form">
            <h4>Nahr√°t novou zpr√°vu</h4>
            <input type="text" id="newsTitle" placeholder="Nadpis zpr√°vy">
            <textarea id="newsText" placeholder="Text zpr√°vy"></textarea>
            <div>
              <label for="newsAttachment">P≈ô√≠loha (voliteln√©):</label>
              <input type="file" id="newsAttachment" accept=".pdf,.doc,.docx,.txt,.jpg,.jpeg,.png">
              <small>Podporovan√© form√°ty: PDF, DOC, TXT, JPG, PNG</small>
            </div>
            <button onclick="uploadNews()">Zve≈ôejnit zpr√°vu</button>
          </div>
          
          <h4>Existuj√≠c√≠ zpr√°vy</h4>
          <div id="adminNewsList"></div>
        </div>
        
        <!-- SPR√ÅVA TRANSAKC√ç -->
        <div id="adminTransactionsTab" class="admin-tab-content">
          <h3>Spr√°va transakc√≠</h3>
          
          <div class="filter-section">
            <select id="adminTransactionFilter" onchange="filterAdminTransactions()">
              <option value="all">V≈°echny transakce</option>
              <option value="pending">ƒåekaj√≠c√≠ na schv√°len√≠</option>
              <option value="approved">Schv√°len√©</option>
              <option value="rejected">Zam√≠tnut√©</option>
            </select>
          </div>
          
          <div id="adminTransactionsList"></div>
        </div>
        
      </div>
    </div>
    
  </div>

  <script>  
    // U≈ΩIVATEL√â
    const users = {
      "admin": {
        fullName: "Administr√°tor port√°lu",
        userName: "admin",
        team: "Administrace",
        teamMembers: "Syst√©mov√Ω administr√°tor",
        personalBalance: 999999999,
        personalBlock: 0,
        teamBalance: "‚àû",
        teamBlock: 0,
        password: "admin123",
        isAdmin: true
      },
      "user1": {
        fullName: "ƒålen vl√°dy SFRI",
        userName: "U≈æivatel 1",
        team: "Vl√°da SFRI",
        teamMembers: "ƒålen A, ƒålen B, ƒålen C",
        personalBalance: 1000000,
        personalBlock: 0,
        teamBalance: "‚àû",
        teamBlock: 0,
        password: "demo123",
        isAdmin: false
      }
    };
    
    // NOVINKY
    let news = JSON.parse(localStorage.getItem('sfriNews')) || [
      {
        id: 1,
        title: "Vl√°da SFRI schv√°lila nov√Ω rozpoƒçet",
        text: "Vl√°da Socialistick√© Federativn√≠ Republiky IngLAND dnes schv√°lila rozpoƒçet na p≈ô√≠≈°t√≠ rok s d≈Ørazem na soci√°ln√≠ programy a rozvoj infrastruktury.",
        date: new Date().toLocaleString('cs-CZ'),
        author: "admin",
        attachment: null,
        attachmentName: null
      }
    ];
    
    // TRANSAKCE
    let transactions = JSON.parse(localStorage.getItem('sfriTransactions')) || [
      {
        id: 1,
        title: "Platba za ≈°koln√≠ pom≈Øcky",
        description: "N√°kup uƒçebnic a pom≈Øcek pro z√°kladn√≠ ≈°koly",
        amount: 500000,
        sender: "user1",
        recipient: "≈†koln√≠ √∫≈ôad",
        date: new Date().toLocaleString('cs-CZ'),
        status: "pending", // pending, approved, rejected
        approvedBy: null,
        approvedDate: null
      },
      {
        id: 2,
        title: "Platba stavby silnice",
        description: "V√Ωstavba nov√© silnice mezi regiony",
        amount: 2500000,
        sender: "admin",
        recipient: "Stavebn√≠ spoleƒçnost ABC",
        date: new Date(Date.now() - 86400000).toLocaleString('cs-CZ'),
        status: "approved",
        approvedBy: "admin",
        approvedDate: new Date(Date.now() - 43200000).toLocaleString('cs-CZ')
      }
    ];
    
    // PROMƒöNN√â
    let currentUser = null;
    let logoutTime = 600;
    let logoutTimerInterval = null;
    
    // FUNKCE
    function showStatus(message, type = 'success') {
      const statusDiv = document.getElementById('statusMessage');
      statusDiv.textContent = message;
      statusDiv.className = `status-message status-${type}`;
      statusDiv.style.display = 'block';
      
      setTimeout(() => {
        statusDiv.style.display = 'none';
      }, 3000);
    }
    
    function checkLogin() {
      const username = document.getElementById('username').value.trim();
      const password = document.getElementById('password').value;
      const loginStatus = document.getElementById('loginStatus');
      
      if (!username || !password) {
        loginStatus.textContent = 'Vypl≈àte u≈æivatelsk√© jm√©no i heslo!';
        loginStatus.className = 'status-message status-error';
        loginStatus.style.display = 'block';
        return;
      }
      
      if (users[username] && users[username].password === password) {
        currentUser = username;
        localStorage.setItem('loggedInUser', username);
        localStorage.setItem('lastLogin', new Date().toLocaleString('cs-CZ'));
        
        loginStatus.style.display = 'none';
        showPortalForUser(username);
        
        document.getElementById('loginSection').style.display = 'none';
        document.getElementById('portalContent').style.display = 'block';
        
        // ZOBRAZIT ADMIN TAB POKUD JE ADMIN
        const adminTabButton = document.getElementById('adminTabButton');
        const transactionsTabButton = document.getElementById('transactionsTabButton');
        if (users[username].isAdmin) {
          adminTabButton.style.display = 'block';
          transactionsTabButton.style.display = 'block';
        } else {
          adminTabButton.style.display = 'none';
          transactionsTabButton.style.display = 'block'; // Transakce vid√≠ v≈°ichni
        }
        
        resetLogoutTimer();
        loadNews();
        loadTransactions();
        if (users[username].isAdmin) {
          loadAdminNews();
          loadAccounts();
          loadAdminTransactions();
          populateRecipientSelect();
        }
        
        showStatus(`V√≠tejte, ${username}!`, 'success');
      } else {
        loginStatus.textContent = 'Neplatn√© p≈ôihla≈°ovac√≠ √∫daje!';
        loginStatus.className = 'status-message status-error';
        loginStatus.style.display = 'block';
      }
    }
    
    function showPortalForUser(username) {
      const user = users[username];
      if (!user) return;
      
      document.getElementById('userFullName').textContent = user.fullName;
      document.getElementById('userName').textContent = user.userName;
      document.getElementById('userTeam').textContent = user.team;
      document.getElementById('userTeamMembers').textContent = user.teamMembers;
      document.getElementById('personalBalance').textContent = user.personalBalance.toLocaleString() + " ILD";
      document.getElementById('personalBlock').textContent = "Blokace: " + user.personalBlock + " ILD";
      document.getElementById('teamBalance').textContent = user.teamBalance + " ILD";
      document.getElementById('teamBlock').textContent = "Blokace: " + user.teamBlock + " ILD";
      
      const lastLogin = localStorage.getItem('lastLogin') || new Date().toLocaleString('cs-CZ');
      document.getElementById('lastLogin').textContent = lastLogin;
    }
    
    function switchToTab(tabName) {
      if (tabName === 'admin') {
        if (!currentUser || !users[currentUser].isAdmin) {
          showStatus('P≈ô√≠stup zam√≠tnut!', 'error');
          return;
        }
      }
      
      document.querySelectorAll('.tab-content')
        .forEach(t => t.classList.remove('active'));
      
      document.querySelectorAll('.tab')
        .forEach(t => t.classList.remove('active'));
      
      document.getElementById(tabName + 'Tab').classList.add('active');
      
      const tabElement = document.querySelector(`.tab[data-tab="${tabName}"]`);
      if (tabElement) {
        tabElement.classList.add('active');
      }
      
      if (tabName === 'admin') {
        switchAdminTab('users');
      } else if (tabName === 'transactions') {
        loadTransactions();
      }
    }
    
    function switchAdminTab(tabName) {
      // Skr√Ωt v≈°echny admin z√°lo≈æky
      document.querySelectorAll('.admin-tab-content').forEach(tab => {
        tab.style.display = 'none';
      });
      
      // Deaktivovat v≈°echny admin tabs
      document.querySelectorAll('.tab[data-admin-tab]').forEach(tab => {
        tab.classList.remove('active');
      });
      
      // Zobrazit vybranou admin z√°lo≈æku
      document.getElementById('admin' + tabName.charAt(0).toUpperCase() + tabName.slice(1) + 'Tab').style.display = 'block';
      
      // Aktivovat odpov√≠daj√≠c√≠ tab
      document.querySelector(`.tab[data-admin-tab="${tabName}"]`).classList.add('active');
      
      // Naƒç√≠st data pokud je pot≈ôeba
      if (tabName === 'users') {
        loadAccounts();
      } else if (tabName === 'transactions') {
        loadAdminTransactions();
      }
    }
    
    // Naƒç√≠st novinky
    function loadNews() {
      const container = document.getElementById('newsContainer');
      container.innerHTML = '';
      
      if (news.length === 0) {
        container.innerHTML = '<p>Zat√≠m nebyly publikov√°ny ≈æ√°dn√© zpr√°vy.</p>';
        return;
      }
      
      const sortedNews = [...news].sort((a, b) => new Date(b.date) - new Date(a.date));
      
      sortedNews.forEach(item => {
        const newsDiv = document.createElement('div');
        newsDiv.className = 'news-item';
        
        let attachmentHtml = '';
        if (item.attachment && item.attachmentName) {
          attachmentHtml = `
            <div class="news-attachment">
              <strong>üìé P≈ô√≠loha:</strong> 
              <a href="${item.attachment}" download="${item.attachmentName}">${item.attachmentName}</a>
            </div>
          `;
        }
        
        newsDiv.innerHTML = `
          <div class="news-date"><strong>${item.date}</strong> | Autor: ${item.author}</div>
          <h3 class="news-title">${item.title}</h3>
          <div class="news-text">${item.text}</div>
          ${attachmentHtml}
        `;
        container.appendChild(newsDiv);
      });
    }
    
    // Naƒç√≠st transakce pro u≈æivatele
    function loadTransactions() {
      const container = document.getElementById('transactionsContainer');
      container.innerHTML = '';
      
      if (transactions.length === 0) {
        container.innerHTML = '<p>≈Ω√°dn√© transakce k zobrazen√≠.</p>';
        return;
      }
      
      const userTransactions = transactions.filter(t => 
        t.sender === currentUser || t.recipient === users[currentUser]?.team
      );
      
      if (userTransactions.length === 0) {
        container.innerHTML = '<p>Nem√°te ≈æ√°dn√© transakce.</p>';
        return;
      }
      
      const sortedTransactions = [...userTransactions].sort((a, b) => new Date(b.date) - new Date(a.date));
      
      sortedTransactions.forEach(transaction => {
        const transactionDiv = document.createElement('div');
        transactionDiv.className = `transaction-item transaction-${transaction.status}`;
        
        let statusText = '';
        let statusColor = '';
        switch(transaction.status) {
          case 'pending':
            statusText = 'ƒåek√° na schv√°len√≠';
            statusColor = '#ff9800';
            break;
          case 'approved':
            statusText = 'Schv√°leno';
            statusColor = '#4caf50';
            break;
          case 'rejected':
            statusText = 'Zam√≠tnuto';
            statusColor = '#f44336';
            break;
        }
        
        transactionDiv.innerHTML = `
          <div class="transaction-header">
            <strong>${transaction.title}</strong>
            <span style="color: ${statusColor}; font-weight: bold;">${statusText}</span>
          </div>
          <div><strong>Popis:</strong> ${transaction.description}</div>
          <div><strong>ƒå√°stka:</strong> ${transaction.amount.toLocaleString()} ILD</div>
          <div><strong>P≈ô√≠jemce:</strong> ${transaction.recipient}</div>
          <div><strong>Datum:</strong> ${transaction.date}</div>
          ${transaction.approvedBy ? `<div><strong>Schv√°lil:</strong> ${transaction.approvedBy} (${transaction.approvedDate})</div>` : ''}
        `;
        container.appendChild(transactionDiv);
      });
    }
    
    // Naƒç√≠st √∫ƒçty do selectu p≈ô√≠jemc≈Ø
    function populateRecipientSelect() {
      const select = document.getElementById('transactionRecipient');
      select.innerHTML = '<option value="">Vyberte p≈ô√≠jemce</option>';
      
      // P≈ôidat t√Ωmy u≈æivatel≈Ø
      const teams = new Set();
      Object.values(users).forEach(user => {
        if (user.team && user.team !== "Administrace") {
          teams.add(user.team);
        }
      });
      
      teams.forEach(team => {
        const option = document.createElement('option');
        option.value = team;
        option.textContent = team;
        select.appendChild(option);
      });
      
      // P≈ôidat pevn√© mo≈ænosti
      const fixedOptions = [
        "≈†koln√≠ √∫≈ôad",
        "Ministerstvo zdravotnictv√≠",
        "Dopravn√≠ podnik",
        "Stavebn√≠ spoleƒçnost ABC",
        "Energetick√° spoleƒçnost"
      ];
      
      fixedOptions.forEach(optionText => {
        const option = document.createElement('option');
        option.value = optionText;
        option.textContent = optionText;
        select.appendChild(option);
      });
    }
    
    // Zobrazit formul√°≈ô pro novou transakci
    function showNewTransactionForm() {
      document.getElementById('newTransactionForm').style.display = 'block';
    }
    
    function hideNewTransactionForm() {
      document.getElementById('newTransactionForm').style.display = 'none';
    }
    
    // Odeslat novou transakci
    function submitTransaction() {
      const title = document.getElementById('transactionTitle').value.trim();
      const description = document.getElementById('transactionDescription').value.trim();
      const amount = parseFloat(document.getElementById('transactionAmount').value);
      const recipient = document.getElementById('transactionRecipient').value;
      
      if (!title || !description || !amount || amount <= 0 || !recipient) {
        showStatus('Vypl≈àte v≈°echna pole spr√°vnƒõ!', 'error');
        return;
      }
      
      const newId = transactions.length > 0 ? Math.max(...transactions.map(t => t.id)) + 1 : 1;
      const newTransaction = {
        id: newId,
        title: title,
        description: description,
        amount: amount,
        sender: currentUser,
        recipient: recipient,
        date: new Date().toLocaleString('cs-CZ'),
        status: "pending",
        approvedBy: null,
        approvedDate: null
      };
      
      transactions.push(newTransaction);
      localStorage.setItem('sfriTransactions', JSON.stringify(transactions));
      
      // Vyƒçistit formul√°≈ô
      document.getElementById('transactionTitle').value = '';
      document.getElementById('transactionDescription').value = '';
      document.getElementById('transactionAmount').value = '';
      document.getElementById('transactionRecipient').selectedIndex = 0;
      
      hideNewTransactionForm();
      loadTransactions();
      if (users[currentUser] && users[currentUser].isAdmin) {
        loadAdminTransactions();
      }
      
      showStatus('Transakce byla odesl√°na ke schv√°len√≠!', 'success');
    }
    
    // Filtrovat transakce
    function filterTransactions() {
      const filter = document.getElementById('transactionFilter').value;
      // Implementace filtrov√°n√≠ by byla podobn√° jako v admin ƒç√°sti
      loadTransactions(); // Prozat√≠m jen znovu naƒç√≠st
    }
    
    // ADMIN FUNKCE
    
    // Vytvo≈ôit nov√Ω u≈æivatelsk√Ω √∫ƒçet
    function createUser() {
      const username = document.getElementById('newUsername').value.trim();
      const password = document.getElementById('newPassword').value;
      const fullName = document.getElementById('newFullName').value.trim();
      const team = document.getElementById('newTeam').value.trim();
      const teamMembers = document.getElementById('newTeamMembers').value.trim();
      const balance = parseFloat(document.getElementById('newBalance').value) || 0;
      const isAdmin = document.getElementById('newIsAdmin').value === 'true';
      
      if (!username || !password || !fullName) {
        showStatus('Vypl≈àte povinn√° pole!', 'error');
        return;
      }
      
      if (users[username]) {
        showStatus('U≈æivatelsk√© jm√©no ji≈æ existuje!', 'error');
        return;
      }
      
      users[username] = {
        fullName: fullName,
        userName: username,
        team: team || "Vl√°da SFRI",
        teamMembers: teamMembers || "ƒålenov√© t√Ωmu",
        personalBalance: balance,
        personalBlock: 0,
        teamBalance: "‚àû",
        teamBlock: 0,
        password: password,
        isAdmin: isAdmin
      };
      
      // Ulo≈æit u≈æivatele do localStorage
      localStorage.setItem('sfriUsers', JSON.stringify(users));
      
      // Vyƒçistit formul√°≈ô
      document.getElementById('newUsername').value = '';
      document.getElementById('newPassword').value = '';
      document.getElementById('newFullName').value = '';
      document.getElementById('newTeam').value = '';
      document.getElementById('newTeamMembers').value = '';
      document.getElementById('newBalance').value = '';
      document.getElementById('newIsAdmin').selectedIndex = 0;
      
      loadAccounts();
      populateRecipientSelect();
      showStatus('U≈æivatelsk√Ω √∫ƒçet byl vytvo≈ôen!', 'success');
    }
    
    // Naƒç√≠st seznam √∫ƒçt≈Ø
    function loadAccounts() {
      const container = document.getElementById('accountsList');
      container.innerHTML = '';
      
      Object.keys(users).forEach(username => {
        const user = users[username];
        const accountDiv = document.createElement('div');
        accountDiv.className = 'account-item';
        
        accountDiv.innerHTML = `
          <div class="account-info">
            <strong>${user.fullName}</strong><br>
            <small>U≈æivatel: ${username} | T√Ωm: ${user.team} | Admin: ${user.isAdmin ? 'Ano' : 'Ne'}</small><br>
            <small>Z≈Østatek: ${user.personalBalance.toLocaleString()} ILD</small>
          </div>
          <div class="account-actions">
            ${username !== 'admin' ? `
              <button onclick="editUser('${username}')" style="background: #2196f3; padding: 5px 10px;">Upravit</button>
              <button onclick="deleteUser('${username}')" style="background: #f44336; padding: 5px 10px;">Smazat</button>
            ` : '<small>Systemov√Ω √∫ƒçet</small>'}
          </div>
        `;
        container.appendChild(accountDiv);
      });
    }
    
    // Upravit u≈æivatele
    function editUser(username) {
      const user = users[username];
      if (!user) return;
      
      const newBalance = prompt(`Nov√Ω z≈Østatek pro ${username}:`, user.personalBalance);
      if (newBalance !== null) {
        const balance = parseFloat(newBalance);
        if (!isNaN(balance)) {
          user.personalBalance = balance;
          localStorage.setItem('sfriUsers', JSON.stringify(users));
          loadAccounts();
          showStatus('Z≈Østatek byl aktualizov√°n!', 'success');
        }
      }
    }
    
    // Smazat u≈æivatele
    function deleteUser(username) {
      if (username === 'admin' || username === currentUser) {
        showStatus('Nelze smazat tento √∫ƒçet!', 'error');
        return;
      }
      
      if (confirm(`Opravdu chcete smazat u≈æivatele ${username}?`)) {
        delete users[username];
        localStorage.setItem('sfriUsers', JSON.stringify(users));
        loadAccounts();
        populateRecipientSelect();
        showStatus('U≈æivatel byl smaz√°n!', 'success');
      }
    }
    
    // Nahr√°t novou zpr√°vu s p≈ô√≠lohou
    function uploadNews() {
      if (!currentUser || !users[currentUser] || !users[currentUser].isAdmin) {
        showStatus('Pouze administr√°tor m≈Ø≈æe publikovat zpr√°vy!', 'error');
        return;
      }
      
      const title = document.getElementById('newsTitle').value.trim();
      const text = document.getElementById('newsText').value.trim();
      const attachmentInput = document.getElementById('newsAttachment');
      
      if (!title || !text) {
        showStatus('Vypl≈àte nadpis i text zpr√°vy!', 'error');
        return;
      }
      
      const newId = news.length > 0 ? Math.max(...news.map(n => n.id)) + 1 : 1;
      const newItem = {
        id: newId,
        title: title,
        text: text,
        date: new Date().toLocaleString('cs-CZ'),
        author: currentUser,
        attachment: null,
        attachmentName: null
      };
      
      // Zpracovat p≈ô√≠lohu pokud je vybr√°na
      if (attachmentInput.files && attachmentInput.files[0]) {
        const file = attachmentInput.files[0];
        const reader = new FileReader();
        
        reader.onload = function(e) {
          newItem.attachment = e.target.result;
          newItem.attachmentName = file.name;
          addNewsItem(newItem);
        };
        
        reader.readAsDataURL(file);
      } else {
        addNewsItem(newItem);
      }
    }
    
    function addNewsItem(newItem) {
      news.push(newItem);
      localStorage.setItem('sfriNews', JSON.stringify(news));
      
      // Vyƒçistit formul√°≈ô
      document.getElementById('newsTitle').value = '';
      document.getElementById('newsText').value = '';
      document.getElementById('newsAttachment').value = '';
      
      // P≈ôenaƒç√≠st zpr√°vy
      loadNews();
      loadAdminNews();
      
      showStatus('Zpr√°va byla √∫spƒõ≈°nƒõ publikov√°na!', 'success');
    }
    
    // Naƒç√≠st zpr√°vy pro administraci
    function loadAdminNews() {
      const container = document.getElementById('adminNewsList');
      container.innerHTML = '';
      
      if (news.length === 0) {
        container.innerHTML = '<p>≈Ω√°dn√© zpr√°vy k zobrazen√≠.</p>';
        return;
      }
      
      const sortedNews = [...news].sort((a, b) => new Date(b.date) - new Date(a.date));
      
      sortedNews.forEach(item => {
        const newsDiv = document.createElement('div');
        newsDiv.className = 'news-item';
        
        let attachmentHtml = '';
        if (item.attachment && item.attachmentName) {
          attachmentHtml = `
            <div class="news-attachment">
              <strong>üìé P≈ô√≠loha:</strong> ${item.attachmentName}
            </div>
          `;
        }
        
        newsDiv.innerHTML = `
          <div class="news-date"><strong>${item.date}</strong> | ID: ${item.id} | Autor: ${item.author}</div>
          <h3 class="news-title">${item.title}</h3>
          <div class="news-text">${item.text}</div>
          ${attachmentHtml}
          <div style="margin-top: 10px;">
            <button onclick="deleteNews(${item.id})" style="background: #f44336; padding: 5px 10px;">Smazat zpr√°vu</button>
          </div>
        `;
        container.appendChild(newsDiv);
      });
    }
    
    // Smazat zpr√°vu
    function deleteNews(id) {
      if (!confirm('Opravdu chcete smazat tuto zpr√°vu?')) {
        return;
      }
      
      const originalLength = news.length;
      news = news.filter(item => item.id !== id);
      localStorage.setItem('sfriNews', JSON.stringify(news));
      
      loadNews();
      loadAdminNews();
      
      showStatus(`Zpr√°va byla smaz√°na. (${originalLength} ‚Üí ${news.length} zpr√°v)`, 'success');
    }
    
    // Naƒç√≠st transakce pro administraci
    function loadAdminTransactions() {
      const container = document.getElementById('adminTransactionsList');
      container.innerHTML = '';
      
      if (transactions.length === 0) {
        container.innerHTML = '<p>≈Ω√°dn√© transakce k zobrazen√≠.</p>';
        return;
      }
      
      const sortedTransactions = [...transactions].sort((a, b) => new Date(b.date) - new Date(a.date));
      
      sortedTransactions.forEach(transaction => {
        const transactionDiv = document.createElement('div');
        transactionDiv.className = `transaction-item transaction-${transaction.status}`;
        
        let statusText = '';
        let statusColor = '';
        switch(transaction.status) {
          case 'pending':
            statusText = 'ƒåek√° na schv√°len√≠';
            statusColor = '#ff9800';
            break;
          case 'approved':
            statusText = 'Schv√°leno';
            statusColor = '#4caf50';
            break;
          case 'rejected':
            statusText = 'Zam√≠tnuto';
            statusColor = '#f44336';
            break;
        }
        
        let actionButtons = '';
        if (transaction.status === 'pending') {
          actionButtons = `
            <div class="transaction-actions">
              <button class="btn-approve" onclick="approveTransaction(${transaction.id})">Schv√°lit</button>
              <button class="btn-reject" onclick="rejectTransaction(${transaction.id})">Zam√≠tnout</button>
            </div>
          `;
        }
        
        transactionDiv.innerHTML = `
          <div class="transaction-header">
            <strong>${transaction.title}</strong>
            <span style="color: ${statusColor}; font-weight: bold;">${statusText}</span>
          </div>
          <div><strong>Popis:</strong> ${transaction.description}</div>
          <div><strong>ƒå√°stka:</strong> ${transaction.amount.toLocaleString()} ILD</div>
          <div><strong>Odes√≠latel:</strong> ${transaction.sender}</div>
          <div><strong>P≈ô√≠jemce:</strong> ${transaction.recipient}</div>
          <div><strong>Datum:</strong> ${transaction.date}</div>
          ${transaction.approvedBy ? `<div><strong>Schv√°lil:</strong> ${transaction.approvedBy} (${transaction.approvedDate})</div>` : ''}
          ${actionButtons}
        `;
        container.appendChild(transactionDiv);
      });
    }
    
    // Schv√°lit transakci
    function approveTransaction(id) {
      const transaction = transactions.find(t => t.id === id);
      if (!transaction) return;
      
      transaction.status = 'approved';
      transaction.approvedBy = currentUser;
      transaction.approvedDate = new Date().toLocaleString('cs-CZ');
      
      // Aktualizovat z≈Østatek odes√≠latele
      if (users[transaction.sender]) {
        users[transaction.sender].personalBalance -= transaction.amount;
      }
      
      localStorage.setItem('sfriTransactions', JSON.stringify(transactions));
      localStorage.setItem('sfriUsers', JSON.stringify(users));
      
      loadTransactions();
      loadAdminTransactions();
      loadAccounts();
      
      showStatus('Transakce byla schv√°lena!', 'success');
    }
    
    // Zam√≠tnout transakci
    function rejectTransaction(id) {
      const transaction = transactions.find(t => t.id === id);
      if (!transaction) return;
      
      transaction.status = 'rejected';
      transaction.approvedBy = currentUser;
      transaction.approvedDate = new Date().toLocaleString('cs-CZ');
      
      localStorage.setItem('sfriTransactions', JSON.stringify(transactions));
      
      loadTransactions();
      loadAdminTransactions();
      
      showStatus('Transakce byla zam√≠tnuta!', 'success');
    }
    
    // Filtrovat transakce v administraci
    function filterAdminTransactions() {
      const filter = document.getElementById('adminTransactionFilter').value;
      // Implementace filtrov√°n√≠
      loadAdminTransactions(); // Prozat√≠m jen znovu naƒç√≠st
    }
    
    function logout() {
      currentUser = null;
      localStorage.removeItem('loggedInUser');
      
      document.getElementById('portalContent').style.display = 'none';
      document.getElementById('loginSection').style.display = 'flex';
      
      document.getElementById('username').value = '';
      document.getElementById('password').value = '';
      document.getElementById('loginStatus').style.display = 'none';
      
      if (logoutTimerInterval) {
        clearInterval(logoutTimerInterval);
      }
      document.getElementById('logoutTimer').textContent = '--:--';
    }
    
    function resetLogoutTimer() {
      logoutTime = 600;
      if (logoutTimerInterval) {
        clearInterval(logoutTimerInterval);
      }
      updateLogoutTimer();
      
      logoutTimerInterval = setInterval(() => {
        logoutTime--;
        updateLogoutTimer();
        
        if (logoutTime <= 0) {
          logout();
          alert('Byl jste automaticky odhl√°≈°en z d≈Øvodu neƒçinnosti.');
        }
      }, 1000);
    }
    
    function updateLogoutTimer() {
      const minutes = Math.floor(logoutTime / 60);
      const seconds = logoutTime % 60;
      document.getElementById('logoutTimer').textContent = 
        `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    }
    
    // ENTER PRO P≈òIHL√Å≈†EN√ç
    document.addEventListener('DOMContentLoaded', function() {
      document.getElementById('password').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          checkLogin();
        }
      });
      
      document.getElementById('username').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          checkLogin();
        }
      });
    });
    
    // AUTO-P≈òIHL√Å≈†EN√ç P≈òI NAƒåTEN√ç STR√ÅNKY
    window.onload = function() {
      // Naƒç√≠st u≈æivatele z localStorage
      const savedUsers = localStorage.getItem('sfriUsers');
      if (savedUsers) {
        try {
          const parsedUsers = JSON.parse(savedUsers);
          Object.assign(users, parsedUsers);
        } catch (e) {
          console.error('Chyba p≈ôi naƒç√≠t√°n√≠ u≈æivatel≈Ø:', e);
        }
      }
      
      const savedUser = localStorage.getItem('loggedInUser');
      
      if (savedUser && users[savedUser]) {
        currentUser = savedUser;
        showPortalForUser(savedUser);
        
        document.getElementById('loginSection').style.display = 'none';
        document.getElementById('portalContent').style.display = 'block';
        
        // ZOBRAZIT ADMIN TAB POKUD JE ADMIN
        const adminTabButton = document.getElementById('adminTabButton');
        const transactionsTabButton = document.getElementById('transactionsTabButton');
        if (users[savedUser].isAdmin) {
          adminTabButton.style.display = 'block';
          transactionsTabButton.style.display = 'block';
        } else {
          adminTabButton.style.display = 'none';
          transactionsTabButton.style.display = 'block';
        }
        
        resetLogoutTimer();
        loadNews();
        loadTransactions();
        if (users[savedUser].isAdmin) {
          loadAdminNews();
          loadAccounts();
          loadAdminTransactions();
          populateRecipientSelect();
        }
      }
      
      // NAƒå√çST NOVINKY
      const savedNews = localStorage.getItem('sfriNews');
      if (savedNews) {
        try {
          news = JSON.parse(savedNews);
        } catch (e) {
          console.error('Chyba p≈ôi naƒç√≠t√°n√≠ novinek:', e);
          news = [];
        }
      }
      
      // NAƒå√çST TRANSAKCE
      const savedTransactions = localStorage.getItem('sfriTransactions');
      if (savedTransactions) {
        try {
          transactions = JSON.parse(savedTransactions);
        } catch (e) {
          console.error('Chyba p≈ôi naƒç√≠t√°n√≠ transakc√≠:', e);
          transactions = [];
        }
      }
    };
  </script>
</body>
</html>
